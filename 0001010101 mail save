Sub SaveDailyCSV_ModelingReport()

    Dim olApp As Object
    Dim olNs As Object
    Dim Inbox As Object
    Dim Items As Object
    Dim Item As Object
    Dim Atmt As Object
    Dim SaveFolder As String
    Dim SenderEmail As String
    Dim TodayDate As Date
    Dim FileName As String
    Dim SavedCount As Integer
    
    ' Create Outlook Application
    Set olApp = CreateObject("Outlook.Application")
    Set olNs = olApp.GetNamespace("MAPI")
    Set Inbox = olNs.GetDefaultFolder(6) ' 6 = olFolderInbox
    Set Items = Inbox.Items

    SaveFolder = "C:\YourFolderPath\"  ' ðŸ” Change to your actual folder
    SenderEmail = "sender@example.com" ' ðŸ” Change to actual sender email
    TodayDate = Date
    SavedCount = 0

    ' Loop through inbox items
    For Each Item In Items
        If Item.Class = 43 Then ' 43 = MailItem
            If Item.ReceivedTime >= TodayDate And _
               InStr(1, Item.Subject, "Modeling Report", vbTextCompare) > 0 And _
               LCase(Item.SenderEmailAddress) = LCase(SenderEmail) Then

                For Each Atmt In Item.Attachments
                    If Right(Atmt.FileName, 4) = ".csv" Then
                        FileName = SaveFolder & Format(Now, "yyyymmdd_hhnnss_") & Atmt.FileName
                        Atmt.SaveAsFile FileName
                        SavedCount = SavedCount + 1
                    End If
                Next Atmt
            End If
        End If
    Next Item

    MsgBox SavedCount & " CSV file(s) saved to: " & SaveFolder, vbInformation

End Sub
